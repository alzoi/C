# Поток исполнения

Поток исполнения это код и некоторое состояние потока (контекст).
Код это набор инструкций в памяти и указатель на следующую инструкцию (значение регистра %rip).
Контекст потока это данные, над которыми работает поток, это значение регистров общего назначения и регистра флагов и содержимое памяти.

Процессу операционная система (ОС) выделяет ресурсу (процессорное время и память).
Поток работает внутри процесса и пользуется той памятью, которая предоставлена процессу.
При создании процесса создаётся один поток и начинает исполнять код, использовать и модифицировать память процесса.
Если в процессе создать несколько потоков, то они будут исполняться одновременно (параллельно) и использовать одно логическое адресное пространство (использовать общую память).

Если потоки живут в разных процессах, то они будут использовать разную память.

Процесс это сущность, которой ОС выделяет ресурсы, поток это сущность, которая потребляет выделенные процессу ресурсы.

## Поток

У каждого потока свой стек, так как стек хранит адреса возвратов из функций и локальные переменные.
Для каждого потока ОС должна выделить память под стек. Регистр %rsp указывает на вершину стека.
При переключении на исполнение кода Потока-i система перезаписывает значение регистра %rsp.
